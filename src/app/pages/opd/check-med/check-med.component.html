<div class="container-fluid pt-2" style="overflow: auto">
  <div class="row">
    <div class="col-lg-3">
      <mat-form-field appearance="outline">
        <mat-label>Barcode HN</mat-label>
        <input
          matInput
          #swiper
          (keyup.enter)="getHN(swiper.value); swiper.value = ''"
        />

        <div style="font-size: 44px" matSuffix>
          <i class="fas fa-barcode" matSuffix style="width: 50px"></i>
        </div>
      </mat-form-field>
    </div>
    <div class="col-lg-9" [hidden]="!patient_drug.length">
      <div class="contract">
        <p>
          <strong>ชื่อ : </strong
          >{{ this.Dataqandcheck ? this.Dataqandcheck.patientName : "-" }}
        </p>
        <p>
          <strong>เลขบัตรประชาชน : </strong
          >{{ this.patient_contract ? this.patient_contract.cid : "-" }}
        </p>
        <p>
          <strong>HN : </strong
          >{{ this.patient_contract ? this.patient_contract.hn : "-" }}
        </p>
        <!-- <p>
          <strong>QUEUE : </strong
          >{{ this.Dataqandcheck ? this.Dataqandcheck.QN : "-" }}
        </p> -->
      </div>
      <div class="contract">
        <p>
          <strong>ที่อยู่ : </strong
          >{{ this.patient_contract ? this.patient_contract.address : "-" }}
        </p>
        <p>
          <strong>เบอร์โทร : </strong
          >{{ this.patient_contract ? this.patient_contract.phone : "-" }}
        </p>
        <p>
          <strong style="color: #f40000">แพ้ยา : </strong
          ><i *ngIf="this.Dataqandcheck?.drugAllergy === 'N'"
            >** ไม่มีแพ้ยา **</i
          >
          <button
            *ngIf="this.Dataqandcheck?.drugAllergy === 'Y'"
            type="button"
            class="btn btn-danger btn-sm"
            (click)="showAllergic(this.patient_contract.cid)"
          >
            ดูแพ้ยา
          </button>
        </p>
      </div>
    </div>
  </div>
  <hr />
  <div [hidden]="!patient_drug.length">
    <div class="card-body p-1">
      <div class="row">
        <div class="col-lg-9" s>
          <mat-form-field appearance="outline">
            <mat-label>Barcode Merdical</mat-label>
            <input
              matInput
              #drugbar
              (keyup.enter)="getDrug(drugbar.value); drugbar.value = ''"
            />

            <div style="font-size: 44px" matSuffix>
              <i class="fas fa-barcode" matSuffix style="width: 50px"></i>
            </div>
          </mat-form-field>
        </div>
        <div class="col-lg-3">
          <mat-form-field class="example-full-width" style="float: right">
            <input matInput (keyup)="applyFilter($event)" #input #swiper />
            <mat-placeholder>ค้นหา</mat-placeholder>
            <mat-icon matSuffix style="font-size: 1.2em">search</mat-icon>
          </mat-form-field>
        </div>
      </div>
      <div class="responsive-table">
        <section class="example-container mat-elevation-z8" tabindex="0">
          <table
            mat-table
            matTableExporter
            [dataSource]="dataSource"
            matSort
            #exporter="matTableExporter"
            class="mat-elevation-z8"
          >
            <!--- Note that these columns can be defined in any order.
              The actual rendered columns are set as a property on the row definition" -->

            <!-- Position Column -->
            <ng-container matColumnDef="drugCode">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                drugCode
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.orderitemcode }}
              </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="drugName">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                drugName
              </th>
              <td mat-cell *matCellDef="let element">
                {{ element.orderitemname }}
              </td>
            </ng-container>

            <!-- Weight Column -->
            <ng-container matColumnDef="amount">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount</th>
              <td mat-cell *matCellDef="let element">
                {{ element.orderqty }}
              </td>
            </ng-container>

            <!-- Symbol Column -->
            <ng-container matColumnDef="takeUnit">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Unit</th>
              <td mat-cell *matCellDef="let element">
                {{ element.orderunitcode }}
              </td>
            </ng-container>
            <ng-container matColumnDef="createdDT">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
              <td mat-cell *matCellDef="let element">
                {{ element.lastmodified }}
              </td>
            </ng-container>
            <ng-container matColumnDef="img">
              <th mat-header-cell *matHeaderCellDef>image</th>
              <td
                mat-cell
                *matCellDef="let element"
                style="text-align: center; width: 150px"
              >
                <img
                  *ngIf="element.pathImage"
                  [src]="'http://192.168.185.160:88/api' + element.pathImage"
                  width="130"
                  height="115"
                  style="padding: 5px; cursor: pointer"
                  (click)="getArrImg(element); lightbox.open(0)"
                />
                <img
                  *ngIf="!element.pathImage"
                  src="http://pizzamana.com/manager/data/file/notfound.png"
                  width="130"
                  height="115"
                  style="padding: 5px; cursor: none"
                />
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr
              mat-row
              [ngClass]="{
                highlightTableColor: row.checkstamp
              }"
              *matRowDef="let row; columns: displayedColumns"
            ></tr>
          </table>
        </section>
        <div>
          <!-- <mat-paginator
            style="float: right"
            [length]="5"
            [pageSize]="5"
            [pageSizeOptions]="[5, 50, 100]"
            showFirstLastButtons
          >
          </mat-paginator> -->
        </div>
      </div>
    </div>
  </div>
</div>
<section>
  <div class="modal fade custom-class" id="exampleModal" data-backdrop="static">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <p
            style="font-size: larger; font-weight: bold"
            class="modal-title"
            id="exampleModalLabel"
          >
            รายการยา
          </p>

          <button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <table class="table table-danger">
            <thead>
              <tr>
                <th style="padding-right: 50px; border-right: 0px">#</th>

                <th style="padding-right: 50px; border-right: 0px">ชื่อยา</th>
                <th style="padding-right: 50px; border-right: 0px">รหัสยา</th>
                <th
                  style="
                    padding-right: 50px;
                    border-right: 0px;
                    white-space: nowrap;
                  "
                >
                  โรงพยาบาล
                </th>
                <th style="padding-right: 50px; border-right: 0px">วันที่</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let i of data_allergic; let x = index">
                <td style="border-right: 0px; vertical-align: middle">
                  <div style="width: 10px">{{ x + 1 }}</div>
                </td>
                <td style="border-right: 0px; vertical-align: middle">
                  {{ i.drugname }}
                </td>
                <td
                  style="
                    border-right: 0px;
                    vertical-align: middle;
                    white-space: nowrap;
                  "
                >
                  {{ i.drugcode }}
                </td>
                <td style="border-right: 0px; vertical-align: middle">
                  {{ i.hosname }}
                </td>
                <td
                  style="
                    border-right: 0px;
                    vertical-align: middle;
                    white-space: nowrap;
                  "
                >
                  {{ i.daterecord }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</section>
